import matplotlib.pyplot as plt
import numpy as np
from labellines import *


def plot_scalesim_res(bandwidths, utils, title):
    avg_bandwidth = np.mean(bandwidths, axis=1)
    avg_util = np.mean(utils, axis=1)

if __name__ == '__main__':
    block_1_losses = [14.414056777954102, 11.127655029296875, 9.494004249572754, 10.342347145080566, 8.769244194030762, 7.682629585266113, 7.67454719543457, 7.458877086639404, 6.757997989654541, 6.902329921722412, 6.65346622467041, 6.633141040802002, 6.28670597076416, 6.146353244781494, 6.343366622924805, 6.3408355712890625, 6.156047821044922, 6.068941593170166, 6.077804088592529, 5.969334602355957, 6.025263786315918, 5.58323860168457, 5.811525344848633, 5.6237897872924805, 5.549233436584473, 5.496838569641113, 5.321660995483398, 5.265505313873291, 5.447713851928711, 4.992177486419678, 5.06410551071167, 4.759194850921631, 4.850709438323975, 5.00157356262207, 4.4995927810668945, 4.757828235626221, 4.729364395141602, 3.9458065032958984, 3.9879157543182373, 4.339344024658203, 3.7130846977233887, 3.6960396766662598, 3.7828807830810547, 3.6451163291931152, 3.10886812210083, 3.42941951751709, 2.531378984451294, 2.763216018676758, 2.6117937564849854, 2.2902016639709473, 2.550039768218994, 2.08506178855896, 1.7862632274627686, 2.070458173751831, 1.77777099609375, 1.7722340822219849, 1.4208558797836304, 1.4659138917922974, 1.5805741548538208, 1.3626456260681152, 1.3911114931106567, 1.161573886871338, 0.9607228636741638, 1.0108193159103394, 0.7118245959281921, 1.1444487571716309, 1.123252272605896, 0.7202404737472534, 0.6663089990615845, 0.46144747734069824, 0.5162560939788818, 0.6218737363815308, 0.580651044845581, 0.6628456115722656, 0.4261925518512726, 0.4834252893924713, 0.430034339427948, 0.21477408707141876, 0.22463873028755188, 0.35214924812316895, 0.3201168477535248, 0.2306126058101654, 0.44299954175949097, 0.1842799186706543, 0.29318106174468994, 0.22739838063716888, 0.28312209248542786, 0.2645717263221741, 0.2834368944168091, 0.08381036669015884, 0.27706313133239746, 0.23140746355056763, 0.42720943689346313, 0.22353671491146088, 0.16479220986366272, 0.21506398916244507, 0.2308007776737213, 0.2562587559223175, 0.25465142726898193, 0.14399093389511108]
    block_2_losses = [13.817732810974121, 13.109991073608398, 11.039527893066406, 11.184159278869629, 10.338383674621582, 10.273204803466797, 9.840024948120117, 9.015861511230469, 8.469786643981934, 9.387155532836914, 8.707538604736328, 8.012042999267578, 7.947946071624756, 7.8401312828063965, 7.5233612060546875, 7.753222465515137, 7.438055038452148, 7.341273784637451, 7.507721424102783, 7.153879165649414, 7.244766712188721, 7.159887790679932, 7.111211776733398, 7.0760273933410645, 6.911206245422363, 7.054475784301758, 6.9332194328308105, 7.019625663757324, 6.932281494140625, 6.971793174743652, 6.826428413391113, 7.052700042724609, 6.921952724456787, 6.846240043640137, 6.692652702331543, 7.066977500915527, 6.898953914642334, 6.821645736694336, 6.895877838134766, 6.731905460357666, 6.6392822265625, 6.851893901824951, 6.754706382751465, 6.697213649749756, 6.665152072906494, 6.893425941467285, 6.697862148284912, 6.830491542816162, 6.776304244995117, 6.8026909828186035, 6.627022743225098, 6.6955952644348145, 6.555233955383301, 6.725211143493652, 6.45554256439209, 6.456503391265869, 6.552921295166016, 6.397872447967529, 6.428071975708008, 6.235977649688721, 6.204556465148926, 6.2909626960754395, 6.182726860046387, 6.069854259490967, 5.929282188415527, 6.195077896118164, 5.883256435394287, 5.90379524230957, 5.879764556884766, 5.895554065704346, 5.576672554016113, 5.585630893707275, 5.885672092437744, 5.296551704406738, 5.627326488494873, 5.1904802322387695, 5.274454116821289, 4.921314239501953, 4.876848220825195, 4.9062371253967285, 5.20376443862915, 4.588059902191162, 4.490423202514648, 4.681253910064697, 4.560354709625244, 4.049076080322266, 4.248353481292725, 3.9520812034606934, 3.9192774295806885, 3.3938989639282227, 3.8213698863983154, 3.5054688453674316, 3.700791358947754, 2.9865148067474365, 3.05308198928833, 2.9194388389587402, 2.932831048965454, 2.8468003273010254, 2.598370313644409, 2.637625217437744]
    block_4_losses = [12.448892593383789, 13.078021049499512, 12.572554588317871, 10.570656776428223, 12.357717514038086, 11.322339057922363, 10.58469009399414, 11.103570938110352, 11.330923080444336, 10.184659957885742, 9.933396339416504, 10.116434097290039, 9.471634864807129, 10.233613014221191, 9.436551094055176, 9.314801216125488, 9.310467720031738, 8.535954475402832, 8.735602378845215, 8.549691200256348, 8.529708862304688, 8.999208450317383, 8.917158126831055, 7.9859442710876465, 8.251354217529297, 8.080376625061035, 7.6580634117126465, 8.101263046264648, 7.715338706970215, 7.329047203063965, 7.581353664398193, 7.346685409545898, 7.354788780212402, 7.4456682205200195, 7.211441516876221, 7.258518695831299, 7.168245315551758, 7.2554755210876465, 7.062066555023193, 7.104745864868164, 7.009830951690674, 6.858647346496582, 6.871182918548584, 7.085208892822266, 7.051028251647949, 6.733532905578613, 6.894711971282959, 6.736762523651123, 6.702633857727051, 6.776155948638916, 6.598175525665283, 6.853095054626465, 6.654848098754883, 6.782935619354248, 6.776015758514404, 6.854230880737305, 6.899484157562256, 6.641913890838623, 6.78983211517334, 6.753098011016846, 6.8816351890563965, 6.773665904998779, 6.638537406921387, 6.7562713623046875, 6.614566802978516, 6.808338165283203, 6.7788543701171875, 6.700314521789551, 6.457874298095703, 6.886267185211182, 6.943059921264648, 6.500414848327637, 6.783637046813965, 6.646114349365234, 6.5643086433410645, 6.7105326652526855, 6.365727424621582, 6.553379535675049, 6.398140907287598, 6.517254829406738, 6.517621040344238, 6.079517841339111, 6.104271411895752, 6.200980186462402, 6.118463516235352, 6.0382080078125, 5.841831207275391, 5.998598098754883, 5.744992733001709, 5.955459117889404, 5.783248424530029, 5.7171196937561035, 5.733950614929199, 5.414740562438965, 5.588580131530762, 5.567289352416992, 5.310295581817627, 5.1414594650268555, 5.2064313888549805, 4.9291300773620605]
    block_8_losses = [13.377559661865234, 13.381887435913086, 13.251765251159668, 14.131303787231445, 13.025235176086426, 12.430926322937012, 13.137493133544922, 12.562003135681152, 12.253554344177246, 13.395190238952637, 13.32774543762207, 12.733075141906738, 12.933233261108398, 12.632162094116211, 12.0065336227417, 12.245064735412598, 11.599388122558594, 10.601776123046875, 11.231156349182129, 11.151358604431152, 11.356710433959961, 10.623403549194336, 10.597171783447266, 10.305031776428223, 10.556323051452637, 9.369674682617188, 9.731731414794922, 9.217704772949219, 9.184124946594238, 9.019235610961914, 9.145147323608398, 8.766654968261719, 9.271198272705078, 8.276373863220215, 8.608807563781738, 8.434027671813965, 8.766626358032227, 8.399847030639648, 8.6431884765625, 7.664709568023682, 8.021723747253418, 8.513806343078613, 7.557931900024414, 8.148204803466797, 7.587564468383789, 7.921928882598877, 7.934162139892578, 7.431829452514648, 7.870854377746582, 7.0553812980651855, 7.664947509765625, 7.673677444458008, 7.653174877166748, 7.395023822784424, 7.570245265960693, 7.57760763168335, 7.755613803863525, 7.530279159545898, 7.3742265701293945, 7.400327682495117, 7.364503383636475, 7.717864513397217, 7.120810508728027, 6.963068008422852, 7.067880630493164, 6.639387607574463, 6.875486850738525, 7.007664203643799, 6.649623394012451, 6.667358875274658, 6.491535663604736, 6.449092864990234, 6.230233192443848, 6.462912559509277, 6.242071628570557, 6.113056659698486]

    plt.plot(range(len(block_1_losses)), block_1_losses, label='n=1')
    plt.plot(range(len(block_2_losses)), block_2_losses, label='n=2')
    plt.plot(range(len(block_4_losses)), block_4_losses, label='n=4')
    plt.plot(range(len(block_8_losses)), block_8_losses, label='n=8')

    plt.title('Training (BCE) Loss vs. Epoch')
    plt.xlabel('Epoch')
    plt.ylabel('Training loss')

    ax = plt.gca()
    labelLines(ax.get_lines(), zorder=2.5)
    plt.show()


