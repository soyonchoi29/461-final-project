import matplotlib.pyplot as plt
import numpy as np
from labellines import *


def plot_scalesim_res(bandwidths, utils, title):
    avg_bandwidth = np.mean(bandwidths, axis=1)
    avg_util = np.mean(utils, axis=1)

if __name__ == '__main__':
    block_1_losses = [12.015450477600098, 10.0649995803833, 8.48071575164795, 7.152895927429199, 6.726081371307373, 6.695528507232666, 6.432936191558838, 6.360062122344971, 6.232622146606445, 6.0275115966796875, 6.025391101837158, 5.928991317749023, 5.815804958343506, 5.70162296295166, 5.456136703491211, 5.448200225830078, 5.140042304992676, 4.8140788078308105, 4.675800323486328, 4.247271537780762, 4.011775016784668, 3.642462968826294, 3.295163154602051, 3.26546049118042, 2.762223720550537, 2.746830463409424, 2.2808263301849365, 2.1351821422576904, 1.7891550064086914, 1.9718660116195679, 1.2514009475708008, 1.5806301832199097, 1.1454414129257202, 1.0623325109481812, 0.49840033054351807, 0.9108354449272156, 0.7062618136405945, 0.6296519637107849, 0.5165931582450867, 0.3392176926136017, 0.38892513513565063, 0.7321822643280029, 0.6464996337890625, 0.4151848256587982, 0.36637336015701294, 0.28379079699516296, 0.3673710525035858, 0.34148165583610535, 0.21866343915462494, 0.2647073268890381]
    block_2_losses = [12.420114517211914, 11.0474271774292, 9.436759948730469, 9.197891235351562, 8.188353538513184, 8.389052391052246, 7.4622650146484375, 7.637112617492676, 7.3352131843566895, 7.1980390548706055, 7.066124439239502, 6.814274311065674, 6.915838241577148, 6.827362537384033, 6.76902961730957, 6.857334136962891, 6.903932094573975, 6.827656269073486, 6.7617597579956055, 6.667606353759766, 6.5750603675842285, 6.615320205688477, 6.531538009643555, 6.542598724365234, 6.675164222717285, 6.608292102813721, 6.6595964431762695, 6.514942646026611, 6.375810146331787, 6.188183784484863, 6.1989593505859375, 6.171443462371826, 5.855246543884277, 5.689931869506836, 5.657771110534668, 5.698692798614502, 5.238187789916992, 5.220378398895264, 5.1095499992370605, 4.859859466552734, 4.578564643859863, 4.356509685516357, 3.9825656414031982, 3.573638916015625, 3.641261577606201, 3.245196580886841, 3.036433458328247, 3.0075461864471436, 2.508103132247925, 2.260122537612915]
    block_4_losses = [12.27463150024414, 12.000870704650879, 11.60624885559082, 10.765240669250488, 10.487278938293457, 9.688926696777344, 9.095471382141113, 8.612992286682129, 9.057877540588379, 8.262910842895508, 8.461167335510254, 7.973602771759033, 8.34748649597168, 8.24000358581543, 7.64296817779541, 7.679511547088623, 7.382064342498779, 7.076404571533203, 7.4487690925598145, 7.236654758453369, 7.058846473693848, 6.82628059387207, 6.705554008483887, 6.655534744262695, 6.823366165161133, 6.828884124755859, 6.773187637329102, 6.789458751678467, 6.829179763793945, 6.885302543640137, 6.6968183517456055, 6.87930965423584, 6.582979679107666, 6.890110969543457, 6.748896598815918, 6.787614822387695, 6.807806491851807, 6.5220465660095215, 6.6204023361206055, 6.274316310882568, 6.434625625610352, 6.167918682098389, 6.199109077453613, 5.966845512390137, 5.985752105712891, 6.066205024719238, 5.7716546058654785, 5.505135536193848, 5.300765514373779, 5.446077823638916]
    block_8_losses = [12.686478614807129, 14.405056953430176, 12.953988075256348, 13.611618995666504, 12.427947998046875, 13.679726600646973, 13.429503440856934, 12.490674018859863, 11.891545295715332, 12.038204193115234, 11.074520111083984, 10.83151626586914, 10.110430717468262, 9.553238868713379, 9.877839088439941, 9.11593246459961, 9.249224662780762, 8.58061408996582, 8.470321655273438, 7.922199726104736, 8.413593292236328, 7.7990899085998535, 8.231124877929688, 7.966094493865967, 7.841211318969727, 7.875217914581299, 7.775172710418701, 7.606539726257324, 7.6258955001831055, 7.3693156242370605, 7.682374477386475, 7.308563709259033, 6.886777877807617, 6.865562915802002, 6.733625411987305, 6.440553188323975, 6.38552188873291, 6.046597957611084]

    plt.plot(range(len(block_1_losses)), block_1_losses, label='n=1')
    plt.plot(range(len(block_2_losses)), block_2_losses, label='n=2')
    plt.plot(range(len(block_4_losses)), block_4_losses, label='n=4')
    plt.plot(range(len(block_8_losses)), block_8_losses, label='n=8')

    plt.title('Training (BCE) Loss vs. Epoch')
    plt.xlabel('Epoch')
    plt.ylabel('Training loss')

    ax = plt.gca()
    labelLines(ax.get_lines(), zorder=2.5)
    plt.show()


