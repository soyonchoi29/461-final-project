import matplotlib.pyplot as plt
import numpy as np
from labellines import *


def plot_scalesim_res(bandwidths, utils, title):
    avg_bandwidth = np.mean(bandwidths, axis=1)
    avg_util = np.mean(utils, axis=1)

if __name__ == '__main__':

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(10, 4))
    # fig.suptitle('Depth-Wise Blocking Effect on Epoch vs. Tr Loss', fontsize=15)
    fig.tight_layout(pad=3.0)
    # plt.rcParams['font.family'] = 'serif'
    font = 'Georgia'

    block_1_losses = [11.808568000793457, 9.57050895690918, 8.09164810180664, 7.102362632751465, 6.583916187286377, 6.176777362823486, 6.2803215980529785, 6.327767372131348, 6.2245774269104, 6.058191299438477, 5.6986517906188965, 5.555741786956787, 5.482507705688477, 5.201842784881592, 5.287065029144287, 4.860864162445068, 5.106873989105225, 4.826452732086182, 4.40455436706543, 3.8627820014953613, 4.043004035949707, 3.0775976181030273, 2.6344127655029297, 2.652780532836914, 2.4226856231689453, 2.0334956645965576, 2.086184024810791, 1.7134608030319214, 1.3878378868103027, 1.2486766576766968, 1.4358309507369995, 0.7232348918914795, 0.6027587056159973, 0.8986386060714722, 0.5112780928611755, 0.6841485500335693, 0.5378713011741638, 0.5188024640083313, 0.735526978969574, 0.37081530690193176, 0.4360634684562683, 0.2580859959125519, 0.2684408128261566, 0.18804241716861725, 0.2756228744983673, 0.44426342844963074, 0.284619003534317, 0.2139233648777008, 0.1327112317085266, 0.3477657437324524]
    block_2_losses = [11.57554817199707, 10.405810356140137, 8.862740516662598, 8.761834144592285, 8.313981056213379, 8.277549743652344, 7.635253429412842, 7.519101619720459, 7.257250785827637, 7.019755840301514, 6.899697303771973, 7.016993522644043, 6.778160572052002, 6.9113054275512695, 6.566699028015137, 6.843136787414551, 6.933796405792236, 6.788914203643799, 6.6536126136779785, 6.734466552734375, 6.743055820465088, 6.58612060546875, 6.563256740570068, 6.72244930267334, 6.6571574211120605, 6.5467705726623535, 6.635805130004883, 6.485846519470215, 6.241707801818848, 6.162015914916992, 6.051253795623779, 6.135819911956787, 5.766809463500977, 5.49991512298584, 5.642550468444824, 5.557464599609375, 5.490249156951904, 5.0404052734375, 4.557791233062744, 4.5895867347717285, 4.28375244140625, 4.2325968742370605, 3.840271234512329, 3.7139127254486084, 3.3462026119232178, 3.2797651290893555, 3.1240530014038086, 2.9476141929626465, 2.501854181289673, 2.303210496902466]
    block_4_losses = [13.0238676071167, 13.891219139099121, 10.951459884643555, 10.743600845336914, 10.922350883483887, 9.998821258544922, 9.28445816040039, 9.071866035461426, 9.21988296508789, 9.164499282836914, 8.525561332702637, 8.247145652770996, 8.164628028869629, 8.527841567993164, 7.735927581787109, 7.494363307952881, 7.5536580085754395, 7.280269145965576, 7.293078422546387, 7.345666408538818, 7.053889274597168, 7.081107139587402, 7.177326679229736, 7.04195499420166, 7.029649257659912, 6.876935958862305, 7.128658294677734, 6.914234638214111, 7.024351119995117, 6.8666534423828125, 6.894969940185547, 6.733574867248535, 6.8619794845581055, 6.866335391998291, 6.953649520874023, 6.888341903686523, 6.830364227294922, 6.673215389251709, 6.615762233734131, 6.674781322479248, 6.558012008666992, 6.562507152557373, 6.139763355255127, 5.877361297607422, 5.795466423034668, 5.707711696624756, 5.9591593742370605, 5.579221725463867]
    block_8_losses = [13.229907035827637, 14.118032455444336, 12.761994361877441, 12.20317268371582, 12.37739372253418, 12.396745681762695, 12.42634391784668, 11.044692039489746, 10.772317886352539, 10.440418243408203, 10.138858795166016, 9.7279691696167, 9.834479331970215, 9.630619049072266, 8.667484283447266, 8.630229949951172, 8.605705261230469, 8.104022026062012, 8.30417251586914, 7.753023624420166, 8.192093849182129, 7.874926567077637, 7.7157793045043945, 7.762691497802734, 7.585200786590576, 7.432244777679443, 7.499301910400391, 7.677306652069092, 7.60664176940918, 7.483373641967773, 7.472837448120117, 6.974554061889648, 6.778665542602539, 6.839441299438477, 6.850176811218262, 6.329312324523926]

    ax1.set_title('AlexNet', fontname=font)
    ax1.plot(range(len(block_1_losses)), block_1_losses, label='n=1')
    ax1.plot(range(len(block_2_losses)), block_2_losses, label='n=2')
    ax1.plot(range(len(block_4_losses)), block_4_losses, label='n=4')
    ax1.plot(range(len(block_8_losses)), block_8_losses, label='n=8')
    ax1.set_xlabel('Epoch', fontsize=12, fontname=font)
    ax1.set_ylabel('Training Loss', fontsize=12, fontname=font)

    block_1_losses = [13.458718299865723, 10.018200874328613, 8.822168350219727, 6.929190158843994, 5.908612251281738, 5.090776443481445, 3.8217544555664062, 3.0832033157348633, 3.0265276432037354, 2.3711507320404053, 1.9950724840164185, 1.4079018831253052, 1.504701852798462, 0.8888946771621704, 0.8781710863113403, 0.5951557755470276, 0.7354245185852051, 0.6392689347267151, 0.6332167387008667, 0.3007294833660126, 0.43279460072517395, 0.28595688939094543, 0.35729989409446716, 0.1842195689678192, 0.09445074200630188, 0.13322193920612335, 0.17809219658374786, 0.03179493173956871, 0.19054485857486725, 0.1871148943901062, 0.07922061532735825, 0.037206124514341354, 0.06704031676054001, 0.06594688445329666, 0.02910109981894493, 0.13274626433849335, 0.0628344938158989, 0.08927911520004272, 0.026912562549114227, 0.023373417556285858, 0.050074148923158646, 0.032955873757600784, 0.0900793969631195, 0.13908204436302185, 0.05278962105512619, 0.03986039757728577, 0.015778619796037674, 0.02353479340672493, 0.0616825670003891, 0.07450571656227112]
    block_2_losses = [12.677656173706055, 12.579170227050781, 12.771347999572754, 12.423535346984863, 12.631704330444336, 12.182866096496582, 11.801047325134277, 12.031261444091797, 11.273136138916016, 11.125802993774414, 11.137442588806152, 10.385847091674805, 11.00224494934082, 10.142073631286621, 10.410699844360352, 10.292489051818848, 9.456518173217773, 10.383122444152832, 8.968236923217773, 9.726102828979492, 9.204615592956543, 8.800437927246094, 8.849406242370605, 8.991086959838867, 8.242767333984375, 8.438191413879395, 6.289947986602783, 5.686373233795166, 5.261282920837402, 4.371156692504883, 3.4526102542877197, 3.0558931827545166, 2.2815263271331787, 2.113487958908081, 1.8746715784072876, 1.7460654973983765, 1.5911428928375244, 1.3783271312713623, 0.8266388773918152, 0.7493323683738708, 0.898831844329834, 0.8526252508163452, 0.5229418277740479, 0.4748696982860565, 0.2353011518716812, 0.17354999482631683, 0.42203694581985474, 0.2289831042289734, 0.19530171155929565, 0.07110584527254105]
    block_4_losses = [13.146313667297363, 12.749176025390625, 12.267602920532227, 12.353825569152832, 12.711181640625, 12.663797378540039, 12.346500396728516, 11.322098731994629, 12.092782974243164, 12.70344352722168, 11.584066390991211, 12.332846641540527, 12.034089088439941, 12.040504455566406, 11.457280158996582, 11.13113784790039, 10.575944900512695, 10.840685844421387, 11.5667142868042, 11.341935157775879, 11.13111686706543, 11.215778350830078, 10.354231834411621, 10.106019020080566, 10.354742050170898, 10.4005126953125, 9.208881378173828, 10.123269081115723, 8.303598403930664, 8.603241920471191, 8.494518280029297, 8.324518203735352, 8.444153785705566, 8.156349182128906, 7.699589729309082, 7.5369696617126465, 7.295068740844727, 6.275791168212891, 5.478389263153076, 4.460735321044922, 4.7571001052856445, 3.6055901050567627, 3.415362596511841, 2.4071083068847656, 2.6551575660705566, 1.781095027923584, 1.7371395826339722, 1.3020472526550293]
    block_8_losses = [12.48620319366455, 12.78400993347168, 13.040607452392578, 11.567095756530762, 12.05249309539795, 12.899845123291016, 12.732985496520996, 14.025738716125488, 13.030309677124023, 13.225053787231445, 12.96789836883545, 13.571314811706543, 12.393790245056152, 13.14872932434082, 13.39428424835205, 12.216256141662598, 13.376068115234375, 13.0699462890625, 13.091678619384766, 11.790133476257324, 11.989060401916504, 12.704607963562012, 12.176478385925293, 11.505066871643066, 11.922518730163574, 11.744476318359375, 12.000846862792969, 11.902325630187988, 11.4341402053833, 10.971314430236816, 11.346749305725098, 10.509629249572754, 11.682206153869629, 10.974687576293945, 10.60577392578125, 10.397937774658203, 10.131420135498047, 9.533435821533203, 10.121722221374512, 9.234099388122559, 8.587701797485352, 9.348418235778809, 8.603286743164062, 6.675716400146484, 6.247898101806641, 5.5567779541015625, 4.930639743804932, 4.426941871643066]

    ax2.set_title('ResNet50', fontname=font)
    ax2.plot(range(len(block_1_losses)), block_1_losses, label='n=1')
    ax2.plot(range(len(block_2_losses)), block_2_losses, label='n=2')
    ax2.plot(range(len(block_4_losses)), block_4_losses, label='n=4')
    ax2.plot(range(len(block_8_losses)), block_8_losses, label='n=8')
    ax2.set_xlabel('Epoch', fontsize=12, fontname=font)
    ax2.set_ylabel('Training Loss', fontsize=12, fontname=font)

    labelLines(ax1.get_lines(), zorder=2.5, fontname=font)
    labelLines(ax2.get_lines(), zorder=2.5, fontname=font)

    plt.show()


